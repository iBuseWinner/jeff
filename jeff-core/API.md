# API

## Оглавление

- [Настройка базы данных](#1)
- [Создание источника](#7)

## Примечания

В целом, работа с API выглядит следующим образом:

1. Пользователь регистрируется и/или получает новый токен.
1. Пользователь отправляет запросы с этим токеном.

## <a name="1"></a> Настройка базы данных

Настройка базы данных проводится единожды, создавая в PostgreSQL шесть таблиц. Но метод может создавать только те таблицы, которые отсутствуют в базе данных, и если вы удалили несколько, вызов этого метода повлечёт создание этих таблиц.

`GET /pg-setup`

Для работы метода необходимо передать заголовок `App-Token`, содержащий закодированный в base64 JSON:

```json
{
  "key": "<Ключ администратора>"
}
```

Метод возвращает код 200 в случае успеха и может возвращать коды 401, 500 в случае ошибки. Текст ошибки передаётся в теле.

## <a name="7"></a> Создание источника

Для хранения выражений, дообучения и импорта требуется как минимум один источник выражений. Тем не менее, самостоятельно источник (например, при регистрации) не создаётся, поэтому следует создать его по запросу.

`PUT /source`

Для работы метода необходимо передать закодированный в base64 токен в заголовке `App-Token`, а в теле запроса - JSON вида:

```json
{
  "header": "Название источника"
}
```

В случае успеха метод возвращает код 200.
